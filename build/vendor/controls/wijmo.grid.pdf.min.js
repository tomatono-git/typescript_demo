/*
    *
    * Wijmo Library 5.20172.359
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),wijmo;(function(n){var t;(function(t){var i;(function(i){'use strict';function r(t,i,u){var f,e,o;if(u===void 0&&(u=!1),i&&t)for(f in i)if(e=i[f],o=t[f],n.isObject(e)){if(o===undefined||!n.isObject(o)&&u)if(n.isFunction(e.clone)){t[f]=o=e.clone();continue}else t[f]=o={};n.isObject(o)&&r(t[f],e,u)}else(o===undefined||u&&e!==undefined)&&(t[f]=e);return t}var u,c,l,f,o;(function(n){n[n.ActualSize=0]="ActualSize";n[n.PageWidth=1]="PageWidth";n[n.SinglePage=2]="SinglePage"})(u=i.ScaleMode||(i.ScaleMode={})),function(n){n[n.All=0]="All";n[n.Selection=1]="Selection"}(c=i.ExportMode||(i.ExportMode={}));l=function(t){function i(i,r,u,f,e,o,s,h,c){var l=t.call(this,i,r)||this;return l.cancelBorders=!1,l._cell=n.asType(u,HTMLElement,!0),l._canvas=f,l._clientRect=e,l._contentRect=o,l._textTop=s,l._style=h,l._getFormattedCell=c,l}return __extends(i,t),Object.defineProperty(i.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"clientRect",{get:function(){return this._clientRect},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!0,configurable:!0}),i.prototype.getFormattedCell=function(){return n.asFunction(this._getFormattedCell)()},Object.defineProperty(i.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"textTop",{get:function(){return this._textTop},enumerable:!0,configurable:!0}),i}(n.grid.CellRangeEventArgs);i.PdfFormatItemEventArgs=l;o=function(){function i(){}return i.draw=function(t,i,f,e,o){n.assert(!!t,'The flex argument cannot be null.');n.assert(!!i,'The doc argument cannot be null.');var s=r({},o);r(s,this.DefaultDrawSettings);s.scaleMode=f==null?u.ActualSize:e==null?u.PageWidth:u.SinglePage;try{s.recalculateStarWidths&&t.columns._updateStarSizes(n.pdf.ptToPx(i.width));this._draw(t,i,null,f,e,s)}finally{s.recalculateStarWidths&&t.invalidate(!0)}},i.drawToPosition=function(t,i,f,e,o,s){n.assert(!!t,'The flex argument cannot be null.');n.assert(!!i,'The doc argument cannot be null.');n.assert(!!f,'The point argument cannot be null.');var h=r({},s);r(h,this.DefaultDrawSettings);h.scaleMode=e==null?u.ActualSize:o==null?u.PageWidth:u.SinglePage;try{h.recalculateStarWidths&&t.columns._updateStarSizes(n.pdf.ptToPx(i.width));this._draw(t,i,f,e,o,h)}finally{h.recalculateStarWidths&&t.invalidate(!0)}},i.export=function(t,i,u){var e,f;n.assert(!!t,'The flex argument cannot be null.');n.assert(!!i,'The fileName argument cannot be empty.');u=r({},u);r(u,this.DefaultExportSettings);e=u.documentOptions.ended;u.documentOptions.ended=function(t,r){e&&e.apply(f,[t,r])===!1||n.pdf.saveBlob(r.blob,i)};f=new n.pdf.PdfDocument(u.documentOptions);try{u.recalculateStarWidths&&t.columns._updateStarSizes(n.pdf.ptToPx(f.width));this._draw(t,f,null,null,null,u);f.end()}finally{u.recalculateStarWidths&&t.invalidate(!0)}},i._draw=function(i,r,u,o,s,h){var nt=u!=null,l=new n.Size(r.width,r.height),c,k;u||(u=new n.Point(0,r.y));n.isArray(h.embeddedFonts)&&h.embeddedFonts.forEach(function(n){r.registerFont(n)});var d=e.getSelection(i,h.exportMode),g=this._getGridRenderer(i,d,!1,this.BorderWidth,null,!0),a=new n.Rect(u.x||0,u.y||0,o||l.width,s||l.height),v=this._getScaleFactor(g,h.scaleMode,a),y=this._getPages(g,d,a,h,nt,v);f=document.createElement('div');f.setAttribute(t.FlexGrid._WJS_MEASURE,'true');f.style.visibility='hidden';i.hostElement.appendChild(f);try{for(c=0;c<y.length;c++){c>0&&r.addPage();var p=y[c],w=p.pageCol===0?a.left:0,b=p.pageRow===0?a.top:0;r.saveState();r.paths.rect(0,0,l.width,l.height).clip();r.scale(v,v,new n.Point(w,b));r.translate(w,b);k=this._getGridRenderer(i,p.range,h.repeatMergedValuesAcrossPages,this.BorderWidth,h.styles,c===y.length-1);k.render(r,h);r.restoreState();r.x=w;r.y=b+k.renderSize.height*v}}finally{f&&(f.parentElement.removeChild(f),f=null)}},i._getScaleFactor=function(n,t,i){var f=1,e,r;return t===u.ActualSize?f:(e=n.renderSize,t===u.SinglePage?(r=Math.min(i.width/e.width,i.height/e.height),r<1&&(f=r)):(r=i.width/e.width,r<1&&(f=r)),f)},i._getPages=function(t,i,r,f,e,o){var ht=this,h=[],c=[],w=n.pdf.pxToPt,b=t.flex,tt=t.showColumnHeader,it=t.showRowHeader,k=tt?w(b.columnHeaders.height):0,g=it?w(b.rowHeaders.width):0,yt=f.scaleMode===u.ActualSize||f.scaleMode===u.PageWidth,pt=f.scaleMode===u.ActualSize,wt=(r.width-r.left)*(1/o),bt=(r.height-r.top)*(1/o),kt=r.width*(1/o),dt=r.height*(1/o),v=k,y=g,ct=e&&f.scaleMode==u.ActualSize,rt,p,ut,ft,nt,et,s,l,st,vt;if(yt&&(rt=0,i.forEach(b.cells,function(n,t,i,r){var f=h.length?dt:bt,u;a.isRenderableRow(n)&&(u=w(n.renderHeight),rt++,v+=u,(tt||rt>1)&&(v-=ht.BorderWidth),v>f&&(k+u>f||ct?(h.push(r),v=k):(h.push(r-1),v=k+u),tt&&(v-=ht.BorderWidth)))})),p=i.length()-1,p<0&&(p=0),h.length&&h[h.length-1]===p||h.push(p),pt)for(ut=0,s=i.leftCol;s<=i.rightCol;s++)ft=b.columns[s],ft.isVisible&&(nt=w(ft.renderWidth),et=c.length?kt:wt,ut++,y+=nt,(it||ut>1)&&(y-=this.BorderWidth),y>et&&(g+nt>et||ct?(c.push(s),y=g):(c.push(s-1),y=g+nt),it&&(y-=this.BorderWidth)));c.length&&c[c.length-1]===i.rightCol||c.push(i.rightCol);var lt=[],ot=!1,at=1,gt=e&&f.maxPages>0?1:f.maxPages;for(s=0;s<h.length&&!ot;s++)for(l=0;l<c.length&&!ot;l++,at++)(ot=at>gt)||(st=s==0?0:h[s-1]+1,vt=l==0?i.leftCol:c[l-1]+1,lt.push(new d(i.subrange(st,h[s]-st+1,vt,c[l]),l,s)));return lt},i._getGridRenderer=function(i,r,u,f,e,o){var s=t.multirow&&i instanceof t.multirow.MultiRow&&p||t.sheet&&i instanceof t.sheet.FlexSheet&&y||n.olap&&i instanceof n.olap.PivotGrid&&w||h;return new s(i,r,u,f,e,o)},i}();o.BorderWidth=1;o.DefaultDrawSettings={maxPages:Number.MAX_VALUE,exportMode:c.All,repeatMergedValuesAcrossPages:!0,recalculateStarWidths:!0,styles:{cellStyle:{font:new n.pdf.PdfFont,padding:1.5,verticalAlign:'middle'},headerCellStyle:{font:{weight:'bold'}},errorCellStyle:{backgroundColor:'rgba(255, 0, 0, 0.3)'}}};o.DefaultExportSettings=r({scaleMode:u.PageWidth,documentOptions:{compress:!1,pageSettings:{margins:{left:36,right:36,top:18,bottom:18}}}},o.DefaultDrawSettings);i.FlexGridPdfConverter=o;var h=function(){function i(n,i,r,u,f,o){this._flex=n;this._borderWidth=u;this._lastPage=o;this._topLeft=new s(this,n.topLeftCells,this.showRowHeader&&this.showColumnHeader?new e(n,[new t.CellRange(0,0,n.topLeftCells.rows.length-1,n.topLeftCells.columns.length-1)]):new e(n,[]),r,u,f);this._rowHeader=new s(this,n.rowHeaders,this.showRowHeader?i.clone(0,n.rowHeaders.columns.length-1):new e(n,[]),r,u,f);this._columnHeader=new s(this,n.columnHeaders,this.showColumnHeader?new e(n,[new t.CellRange(0,i.leftCol,n.columnHeaders.rows.length-1,i.rightCol)]):new e(n,[]),r,u,f);this._cells=new s(this,n.cells,i,r,u,f);this._bottomLeft=new s(this,n.bottomLeftCells,this.showRowHeader&&this.showColumnFooter?new e(n,[new t.CellRange(0,0,n.bottomLeftCells.rows.length-1,n.bottomLeftCells.columns.length-1)]):new e(n,[]),r,u,f);this._columnFooter=new s(this,n.columnFooters,this.showColumnFooter?new e(n,[new t.CellRange(0,i.leftCol,n.columnFooters.rows.length-1,i.rightCol)]):new e(n,[]),r,u,f)}return i.prototype.render=function(n,t){var r=Math.max(0,Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)-this._borderWidth),i=Math.max(0,Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)-this._borderWidth);this._topLeft.render(n,0,0,t);this._rowHeader.render(n,0,i,t);this._columnHeader.render(n,r,0,t);this._cells.render(n,r,i,t);i=Math.max(0,i+this._cells.renderSize.height-this._borderWidth);this._bottomLeft.render(n,0,i,t);this._columnFooter.render(n,r,i,t)},Object.defineProperty(i.prototype,"flex",{get:function(){return this._flex},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"renderSize",{get:function(){var t=Math.max(this._topLeft.renderSize.height,this._columnHeader.renderSize.height)+Math.max(this._rowHeader.renderSize.height,this._cells.renderSize.height)+Math.max(this._bottomLeft.renderSize.height,this._columnFooter.renderSize.height),i=Math.max(this._topLeft.renderSize.width,this._rowHeader.renderSize.width)+Math.max(this._columnHeader.renderSize.width,this._cells.renderSize.width);return this._columnHeader.visibleRows>0&&(t-=this._borderWidth),this._columnFooter.visibleRows>0&&(t-=this._borderWidth),this._rowHeader.visibleColumns>0&&(i-=this._borderWidth),new n.Size(i,t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showColumnHeader",{get:function(){return!!(this._flex.headersVisibility&t.HeadersVisibility.Column)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showRowHeader",{get:function(){return!!(this._flex.headersVisibility&t.HeadersVisibility.Row)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showColumnFooter",{get:function(){return this._lastPage&&this._flex.columnFooters.rows.length>0},enumerable:!0,configurable:!0}),i.prototype.alignMergedTextToTheTopRow=function(){return!1},i.prototype.getCellValue=function(n,t,i){return n.getCellData(i,t,!0)},i.prototype.getColumn=function(n,t){return n.columns[t]},i.prototype.isAlternatingRow=function(n){return n.index%2!=0},i.prototype.isMergeableCell=function(){return!0},i}(),y=function(n){function i(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return __extends(i,n),i.prototype.getCellValue=function(i,r,u){return i.cellType===t.CellType.Cell?i.rows[u]instanceof t.sheet.HeaderRow?this.flex.columnHeaders.getCellData(u,r,!0):this.flex.getCellValue(u,r,!0):n.prototype.getCellValue.call(this,i,r,u)},Object.defineProperty(i.prototype,"showColumnHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showRowHeader",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"showColumnFooter",{get:function(){return!1},enumerable:!0,configurable:!0}),i}(h),p=function(n){function i(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return __extends(i,n),i.prototype.getColumn=function(n,t,i){return this.flex.getBindingColumn(n,i,t)},i.prototype.isAlternatingRow=function(i){return i instanceof t.multirow._MultiRow?i.dataIndex%2!=0:n.prototype.isAlternatingRow.call(this,i)},i.prototype.isMergeableCell=function(){return!0},i}(h),w=function(n){function i(t,i,r,u,f,e){return n.call(this,t,i,r,u,f,e)||this}return __extends(i,n),i.prototype.alignMergedTextToTheTopRow=function(n){return!this.flex.centerHeadersVertically&&(n.cellType===t.CellType.ColumnHeader||n.cellType===t.CellType.RowHeader)},i}(h),a=function(){function i(n,t){this._panel=n;this._range=t.clone()}return i.isRenderableRow=function(n){return n.isVisible&&!(n instanceof t._NewRowTemplate)},Object.defineProperty(i.prototype,"visibleRows",{get:function(){var n=this;return this._visibleRows==null&&(this._visibleRows=0,this._range.forEach(this._panel,function(t){n.isRenderableRow(t)&&n._visibleRows++})),this._visibleRows},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"visibleColumns",{get:function(){if(this._visibleColumns==null&&(this._visibleColumns=0,this._range.isValid))for(var n=this._range.leftCol;n<=this._range.rightCol;n++)this._panel.columns[n].isVisible&&this._visibleColumns++;return this._visibleColumns},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"size",{get:function(){if(this._size==null){var t=this._range.getRenderSize(this._panel);this._size=new n.Size(n.pdf.pxToPt(t.width),n.pdf.pxToPt(t.height))}return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"panel",{get:function(){return this._panel},enumerable:!0,configurable:!0}),i.prototype.isRenderableRow=function(n){return i.isRenderableRow(n)},i}(),s=function(i){function r(n,t,r,u,f,e){var o=i.call(this,t,r)||this;return o._gr=n,o._repeatMergedValues=u,o._borderWidth=f,o._styles=e,o}return __extends(r,i),Object.defineProperty(r.prototype,"gr",{get:function(){return this._gr},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"styles",{get:function(){return this._styles},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderSize",{get:function(){return this._renderSize==null&&(this._renderSize=this.size.clone(),this.visibleColumns>1&&(this._renderSize.width-=this._borderWidth*(this.visibleColumns-1)),this.visibleRows>1&&(this._renderSize.height-=this._borderWidth*(this.visibleRows-1))),this._renderSize},enumerable:!0,configurable:!0}),r.prototype.getRangeWidth=function(t,i){for(var e,r=0,u=0,o=this.panel,f=t;f<=i;f++)e=o.columns[f],e.isVisible&&(u++,r+=e.renderWidth);return r=n.pdf.pxToPt(r),u>1&&(r-=this._borderWidth*(u-1)),r},r.prototype.getRangeHeight=function(t,i){for(var e,r=0,u=0,o=this.panel,f=t;f<=i;f++)e=o.rows[f],this.isRenderableRow(e)&&(u++,r+=e.renderHeight);return r=n.pdf.pxToPt(r),u>1&&(r=r-this._borderWidth*(u-1)),r},r.prototype.render=function(t,i,r,u){var f=this,e=this.range,s=this.panel,l=new k(this._gr.flex),c=new v(s,0,0,0,0),a=new b(this,t,u,this._borderWidth),o,h;if(e.isValid){for(o={},h=e.leftCol;h<=e.rightCol;h++)o[h]=r;e.forEach(s,function(t,r,u){var nt,h,w,v,g;if(f.isRenderableRow(t))for(nt=i,h=e.leftCol;h<=e.rightCol;h++){var tt=f.gr.getColumn(s,h,u),y=undefined,p=undefined,b,k=!1,d=undefined;if(tt.isVisible){if(w=f._getCellValue(h,u),v=null,f.gr.isMergeableCell(tt,t)&&(v=l.getMergedRange(s,u,h)))if(c.copyFrom(v),v.topRow!==v.bottomRow)v.firstVisibleRow===u||u===r.topRow?(k=!0,b=f._repeatMergedValues?w:v.firstVisibleRow===u?w:'',y=f.getRangeHeight(u,Math.min(v.bottomRow,r.bottomRow)),p=f.getRangeWidth(h,h)):p=f.getRangeWidth(h,h);else for(k=!0,b=f._repeatMergedValues?w:h===v.leftCol?w:'',y=f.getRangeHeight(u,u),p=f.getRangeWidth(Math.max(e.leftCol,v.leftCol),Math.min(e.rightCol,v.rightCol)),d=Math.min(e.rightCol,v.rightCol),g=h+1;g<=d;g++)o[g]+=y-f._borderWidth;else c.setRange(u,h,u,h),k=!0,b=w,y=f.getRangeHeight(u,u),p=f.getRangeWidth(h,h);k&&a.renderCell(b,t,tt,c,new n.Rect(nt,o[h],p,y));y&&(o[h]+=y-f._borderWidth);p&&(nt+=p-f._borderWidth);d&&(h=d)}}})}},r.prototype._getCellValue=function(n,i){var u=this.panel,o=this.gr.getCellValue(u,n,i),r,f,e;return o||u.cellType!==t.CellType.Cell||(r=u.rows[i],r instanceof t.GroupRow&&r.dataItem&&r.dataItem.groupDescription&&n===u.columns.firstVisibleIndex&&(f=r.dataItem.groupDescription.propertyName,e=u.columns.getColumn(f),e&&e.header&&(f=e.header),o=f+': '+r.dataItem.name+' ('+r.dataItem.items.length+' items)')),o},r}(a),b=function(){function i(n,t,i,r){this._pr=n;this._area=t;this._settings=i||{};this._borderWidth=r}return i.prototype.renderCell=function(i,r,u,e,o){var a,p=r.grid,v=this._pr.panel,d=function(){var n=e.topRow,t=e.leftCol,i=v.getCellElement(n,t);return i||(f.style.cssText='',f.className='',p.cellFactory.updateCell(v,n,t,f)),i||f},g=function(n){return n.className=n.className.replace('wj-state-selected',''),n.className=n.className.replace('wj-state-multi-selected',''),window.getComputedStyle(n)},w=!!this._settings.customCellContent,y=null,s=this._getMergedCellStyle(r,u),h,c,b,k;if(w&&(y=d()),w&&(i=y.textContent.trim(),!i&&this._isBooleanCell(u,r,v)&&(i=this._extractCheckboxValue(y)+'')),w&&(h=g(y),s.color=h.color,s.backgroundColor=h.backgroundColor,s.borderColor=h.borderColor||h.borderRightColor||h.borderBottomColor||h.borderLeftColor||h.borderTopColor,s.font=new n.pdf.PdfFont(h.fontFamily,n.pdf._asPt(h.fontSize,!0,undefined),h.fontStyle,h.fontWeight),s.textAlign=h.textAlign),s.boxSizing='border-box',s.borderWidth=this._borderWidth,s.borderStyle='solid',s.textAlign||r instanceof t.GroupRow&&!u.aggregate||(s.textAlign=u.getAlignment()),v.cellType===t.CellType.Cell&&p.rows.maxGroupLevel>=0&&e.leftCol===p.columns.firstVisibleIndex){var nt=r instanceof t.GroupRow?Math.max(r.level,0):p.rows.maxGroupLevel+1,tt=n.pdf._asPt(s.paddingLeft||s.padding),it=n.pdf.pxToPt(nt*p.treeIndent);s.paddingLeft=tt+it}c=this._measureCell(i,u,r,v,s,o);b=e.rowSpan>1&&e.visibleRowsCount>1&&this._pr.gr.alignMergedTextToTheTopRow(v);b&&(k=new n.Rect(c.contentRect.left,c.contentRect.top,c.contentRect.width,c.contentRect.height/(e.visibleRowsCount||1)),c.textRect=this._calculateTextRect(i,u,r,v,k,s));n.isFunction(this._settings.formatItem)&&(a=new l(v,e,y,this._area,c.rect,c.contentRect,c.textRect.top,s,function(){return y||d()}),a.data=i,this._settings.formatItem(a),a.data!==i&&(i=n.asString(a.data),c.textRect=this._calculateTextRect(i,u,r,v,b?k:c.contentRect,s)));this._renderCell(i,r,u,e,c,s,a?!a.cancel:!0,a?!a.cancelBorders:!0)},i.prototype._renderCell=function(n,t,i,r,u,f,e,o){if(e||o){var s=this._pr.panel,h=s.grid;this._isBooleanCellAndValue(n,i,t,s)?this._renderBooleanCell(n,u,f,e,o):this._renderTextCell(n,u,f,e,o)}},i.prototype._getMergedCellStyle=function(n,i){var u=this._pr.styles,f=r({},u.cellStyle),e=this._pr.panel,o=this._pr.gr.flex;switch(e.cellType){case t.CellType.Cell:this._isGroupRow(n)?r(f,u.groupCellStyle,!0):this._pr.gr.isAlternatingRow(n)&&r(f,u.altCellStyle,!0);break;case t.CellType.ColumnHeader:case t.CellType.RowHeader:case t.CellType.TopLeft:case t.CellType.BottomLeft:r(f,u.headerCellStyle,!0);break;case t.CellType.ColumnFooter:r(f,u.headerCellStyle,!0);r(f,u.footerCellStyle,!0)}return!this._settings.customCellContent&&o._getShowErrors()&&o._getError(e,n.index,i.index)&&r(f,u.errorCellStyle,!0),f},i.prototype._isBooleanCellAndValue=function(n,t,i,r){return this._isBooleanCell(t,i,r)&&this._isBoolean(n)},i.prototype._isBooleanCell=function(i,r,u){return i.dataType===n.DataType.Boolean&&u.cellType===t.CellType.Cell&&!this._isGroupRow(r)},i.prototype._isBoolean=function(t){var i=n.isString(t)&&t.toLowerCase();return i==='true'||i==='false'||t===!0||t===!1},i.prototype._isGroupRow=function(n){return n instanceof t.GroupRow&&n.hasChildren},i.prototype._measureCell=function(t,i,r,u,f,e){this._decompositeStyle(f);var v=e.left,y=e.top,s=e.height,h=e.width,a=this._parseBorder(f),p=a.left.width,w=a.top.width,g=a.bottom.width,nt=a.right.width,o=this._parsePadding(f),c=0,l=0,b=0,k=0;if(f.boxSizing==='content-box'||f.boxSizing===undefined)c=o.top+s+o.bottom,l=o.left+h+o.right,b=s,k=h;else{if(f.boxSizing==='border-box')n.pdf._IE&&f instanceof CSSStyleDeclaration?(c=o.top+o.bottom+s,l=o.left+o.right+h):(c=s-w-g,l=h-p-nt);else throw'Invalid value: '+f.boxSizing;b=c-o.top-o.bottom;k=l-o.left-o.right}var e=new n.Rect(v,y,h,s),tt=new n.Rect(v+p,y+w,l,c),d=new n.Rect(v+p+o.left,y+w+o.top,k,b),it=this._calculateTextRect(t,i,r,u,d,f);return{rect:e,clientRect:tt,contentRect:d,textRect:it}},i.prototype._decompositeStyle=function(n){if(n){var t;(t=n.borderColor)&&(n.borderLeftColor||(n.borderLeftColor=t),n.borderRightColor||(n.borderRightColor=t),n.borderTopColor||(n.borderTopColor=t),n.borderBottomColor||(n.borderBottomColor=t));(t=n.borderWidth)&&(n.borderLeftWidth||(n.borderLeftWidth=t),n.borderRightWidth||(n.borderRightWidth=t),n.borderTopWidth||(n.borderTopWidth=t),n.borderBottomWidth||(n.borderBottomWidth=t));(t=n.borderStyle)&&(n.borderLeftStyle||(n.borderLeftStyle=t),n.borderRightStyle||(n.borderRightStyle=t),n.borderTopStyle||(n.borderTopStyle=t),n.borderBottomStyle||(n.borderBottomStyle=t));(t=n.padding)&&(n.paddingLeft||(n.paddingLeft=t),n.paddingRight||(n.paddingRight=t),n.paddingTop||(n.paddingTop=t),n.paddingBottom||(n.paddingBottom=t))}},i.prototype._parseBorder=function(t){var i={left:{width:0},top:{width:0},bottom:{width:0},right:{width:0}};return t.borderLeftStyle!=='none'&&(i.left={width:n.pdf._asPt(t.borderLeftWidth),style:t.borderLeftStyle,color:t.borderLeftColor}),t.borderTopStyle!=='none'&&(i.top={width:n.pdf._asPt(t.borderTopWidth),style:t.borderTopStyle,color:t.borderTopColor}),t.borderBottomStyle!=='none'&&(i.bottom={width:n.pdf._asPt(t.borderBottomWidth),style:t.borderBottomStyle,color:t.borderBottomColor}),t.borderRightStyle!=='none'&&(i.right={width:n.pdf._asPt(t.borderRightWidth),style:t.borderRightStyle,color:t.borderRightColor}),i},i.prototype._parsePadding=function(t){return{left:n.pdf._asPt(t.paddingLeft),top:n.pdf._asPt(t.paddingTop),bottom:n.pdf._asPt(t.paddingBottom),right:n.pdf._asPt(t.paddingRight)}},i.prototype._renderEmptyCell=function(t,i,r,u){var e=t.rect.left,o=t.rect.top,h=t.clientRect.width,c=t.clientRect.height,d=t.rect.height,g=t.rect.width,f=t.clientRect.left-t.rect.left,s=t.clientRect.top-t.rect.top,l=t.rect.top+t.rect.height-(t.clientRect.top+t.clientRect.height),a=t.rect.left+t.rect.width-(t.clientRect.left+t.clientRect.width),y,p;if(u&&(f||a||l||s)){var v=i.borderLeftColor||i.borderColor,w=i.borderRightColor||i.borderColor,b=i.borderTopColor||i.borderColor,k=i.borderBottomColor||i.borderColor;f&&s&&l&&a&&f===a&&f===l&&f===s&&v===w&&v===k&&v===b?(y=f,p=y/2,this._area.paths.rect(e+p,o+p,h+y,c+y).stroke(new n.pdf.PdfPen(v,y))):(f&&this._area.paths.polygon([[e,o],[e+f,o+s],[e+f,o+s+c],[e,o+s+c+l]]).fill(v),s&&this._area.paths.polygon([[e,o],[e+f,o+s],[e+f+h,o+s],[e+f+h+a,o]]).fill(b),a&&this._area.paths.polygon([[e+f+h+a,o],[e+f+h,o+s],[e+f+h,o+s+c],[e+f+h+a,o+s+c+l]]).fill(w),l&&this._area.paths.polygon([[e,o+s+c+l],[e+f,o+s+c],[e+f+h,o+s+c],[e+f+h+a,o+s+c+l]]).fill(k))}r&&i.backgroundColor&&h>0&&c>0&&this._area.paths.rect(e+f,o+s,h,c).fill(i.backgroundColor)},i.prototype._renderBooleanCell=function(t,i,r,u,f){if(this._renderEmptyCell(i,r,u,f),u){var h=.5,l=i.textRect.left,a=i.textRect.top,e=i.textRect.height;if(this._area.paths.rect(l,a,e,e).fillAndStroke(n.Color.fromRgba(255,255,255),new n.pdf.PdfPen(undefined,h)),n.changeType(t,n.DataType.Boolean,'')===!0){var c=e/20,o=e-h-c*2,s=e/8;this._area._pdfdoc.saveState();this._area.translate(l+h/2+c,a+h/2+c).paths.moveTo(s/2,o*.6).lineTo(o-o*.6,o-s).lineTo(o-s/2,s/2).stroke(new n.pdf.PdfPen(undefined,s));this._area._pdfdoc.restoreState()}}},i.prototype._renderTextCell=function(t,i,r,u,f){(this._renderEmptyCell(i,r,u,f),u)&&t&&this._area.drawText(t,i.textRect.left,i.textRect.top,{brush:r.color,font:r.font,height:i.textRect.height,width:i.textRect.width,align:r.textAlign==='center'?n.pdf.PdfTextHorizontalAlign.Center:r.textAlign==='right'?n.pdf.PdfTextHorizontalAlign.Right:r.textAlign==='justify'?n.pdf.PdfTextHorizontalAlign.Justify:n.pdf.PdfTextHorizontalAlign.Left})},i.prototype._calculateTextRect=function(n,t,i,r,u,f){var e=u.clone(),s,o;if(this._isBooleanCellAndValue(n,t,i,r)){s=this._area.measureText('A',f.font,{width:Infinity}).size.height;switch(f.verticalAlign){case'middle':e.top=u.top+u.height/2-s/2;break;case'bottom':e.top=u.top+u.height-s}switch(f.textAlign){case'justify':case'center':e.left=u.left+u.width/2-s/2;break;case'right':e.left=u.left+u.width-s}e.height=e.width=s}else if(e.height>0&&e.width>0)switch(f.verticalAlign){case'bottom':o=this._area.measureText(n,f.font,{height:e.height,width:e.width});o.size.height<e.height&&(e.top+=e.height-o.size.height,e.height=o.size.height);break;case'middle':o=this._area.measureText(n,f.font,{height:e.height,width:e.width});o.size.height<e.height&&(e.top+=e.height/2-o.size.height/2,e.height=o.size.height)}return e},i.prototype._extractCheckboxValue=function(n){var t=n.querySelector('input.wj-cell-check[type=checkbox]'),i;return t&&(i=window.getComputedStyle(t),i.display!=='none'&&i.visibility!=='hidden')?t.checked:undefined},i}(),k=function(){function n(n){this._columns={};this._flex=n}return n.prototype.getMergedRange=function(n,t,i){var r=this._columns[i],u;return r&&t>=r.topRow&&t<=r.bottomRow?r:(u=this._flex.getMergedRange(n,t,i,!1),this._columns[i]=u?new v(n,u):null)},n}(),v=function(n){function i(i,r,u,f,e){var o=this,s;o=r instanceof t.CellRange?n.call(this,r.row,r.col,r.row2,r.col2)||this:n.call(this,r,u,f,e)||this;o.firstVisibleRow=-1;o.visibleRowsCount=0;var c=o.topRow,l=o.bottomRow,h=i.rows.length;if(h>0)for(s=c;s<=l&&s<h;s++)i.rows[s].isVisible&&(o.firstVisibleRow<0&&(o.firstVisibleRow=s),o.visibleRowsCount++);return o}return __extends(i,n),i.prototype.copyFrom=function(n){this.setRange(n.row,n.col,n.row2,n.col2);this.firstVisibleRow=n.firstVisibleRow;this.visibleRowsCount=n.visibleRowsCount},i}(t.CellRange),e=function(){function i(n,t){this._flex=n;this._ranges=t||[]}return i.getSelection=function(n,r){var f=[],o,e,u,s;if(r===c.All)f.push(new t.CellRange(0,0,n.rows.length-1,n.columns.length-1));else{o=n.selection;switch(n.selectionMode){case t.SelectionMode.Cell:case t.SelectionMode.CellRange:f.push(o);break;case t.SelectionMode.Row:f.push(new t.CellRange(o.topRow,0,o.topRow,n.cells.columns.length-1));break;case t.SelectionMode.RowRange:f.push(new t.CellRange(o.topRow,0,o.bottomRow,n.cells.columns.length-1));break;case t.SelectionMode.ListBox:for(e=-1,u=0;u<n.rows.length;u++)s=n.rows[u],s.isSelected?(e<0&&(e=u),u===n.rows.length-1&&f.push(new t.CellRange(e,0,u,n.cells.columns.length-1))):(e>=0&&f.push(new t.CellRange(e,0,u-1,n.cells.columns.length-1)),e=-1)}}return new i(n,f)},i.prototype.length=function(){for(var n,i=0,t=0;t<this._ranges.length;t++)n=this._ranges[t],n.isValid&&(i+=n.bottomRow-n.topRow+1);return i},Object.defineProperty(i.prototype,"isValid",{get:function(){return this._ranges.length&&this._ranges[0].isValid},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"leftCol",{get:function(){return this._ranges.length?this._ranges[0].leftCol:-1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"rightCol",{get:function(){return this._ranges.length?this._ranges[0].rightCol:-1},enumerable:!0,configurable:!0}),i.prototype.clone=function(n,t){for(var r,f=[],u=0;u<this._ranges.length;u++)r=this._ranges[u].clone(),arguments.length>0&&(r.col=n),arguments.length>1&&(r.col2=t),f.push(r);return new i(this._flex,f)},i.prototype.getRenderSize=function(t){for(var u,i=new n.Size(0,0),r=0;r<this._ranges.length;r++)u=this._ranges[r].getRenderSize(t),i.width=Math.max(i.width,u.width),i.height+=u.height;return i},i.prototype.forEach=function(n,t){for(var i,r,f=0,u=0;u<this._ranges.length;u++)if(i=this._ranges[u],i.isValid)for(r=i.topRow;r<=i.bottomRow;r++)t(n.rows[r],i,r,f++)},i.prototype.subrange=function(n,r,u,f){var l=[],o,s,h,e;if(n>=0&&r>0)for(o=0,s=0,h=0;h<this._ranges.length&&r>0;h++,o=s+1)if(e=this._ranges[h],s=o+(e.bottomRow-e.topRow),!(n>s)){var c=n>o?e.topRow+(n-o):e.topRow,a=Math.min(e.bottomRow,c+r-1),v=arguments.length>2?u:e.leftCol,y=arguments.length>2?f:e.rightCol;l.push(new t.CellRange(c,v,a,y));r-=a-c+1}return new i(this._flex,l)},i}(),d=function(){function n(n,t,i){this._col=t;this._row=i;this._range=n}return Object.defineProperty(n.prototype,"range",{get:function(){return this._range},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageCol",{get:function(){return this._col},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"pageRow",{get:function(){return this._row},enumerable:!0,configurable:!0}),n}()})(i=t.pdf||(t.pdf={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={}))