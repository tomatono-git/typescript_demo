/*
    *
    * Wijmo Library 5.20172.359
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),wijmo;(function(n){var t;(function(t){var i;(function(i){'use strict';var u=function(){function i(){}return i.save=function(n,t,i){var r=this._saveFlexGridToWorkbook(n,t);return i&&r.save(i),r},i.saveAsync=function(n,t,i,r,u){var f=this._saveFlexGridToWorkbook(n,t);return f.saveAsync(i,r,u),f},i.load=function(t,i,r){var e=this,u,f;if(i instanceof Blob)u=new FileReader,u.onload=function(){var f=n.xlsx.Workbook._base64EncArr(new Uint8Array(u.result)),i=new n.xlsx.Workbook;i.load(f);f=null;t.deferUpdate(function(){e._loadToFlexGrid(t,i,r);i=null})},u.readAsArrayBuffer(i);else if(i instanceof n.xlsx.Workbook)t.deferUpdate(function(){e._loadToFlexGrid(t,i,r);i=null});else{if(i instanceof ArrayBuffer)i=n.xlsx.Workbook._base64EncArr(new Uint8Array(i));else if(!n.isString(i))throw'Invalid workbook.';f=new n.xlsx.Workbook;f.load(i);i=null;t.deferUpdate(function(){e._loadToFlexGrid(t,f,r);f=null})}},i.loadAsync=function(t,i,r,u,f){var o=this,e,s;if(i instanceof Blob)e=new FileReader,e.onload=function(){var i=n.xlsx.Workbook._base64EncArr(new Uint8Array(e.result)),s=new n.xlsx.Workbook;s.loadAsync(i,function(n){i=null;s=null;t.deferUpdate(function(){o._loadToFlexGrid(t,n,r);u&&u(n);n=null})},f)},e.readAsArrayBuffer(i);else if(i instanceof n.xlsx.Workbook)t.deferUpdate(function(){o._loadToFlexGrid(t,i,r);u&&u(i);i=null});else{if(i instanceof ArrayBuffer)i=n.xlsx.Workbook._base64EncArr(new Uint8Array(i));else if(!n.isString(i))throw'Invalid workbook.';s=new n.xlsx.Workbook;s.loadAsync(i,function(n){i=null;t.deferUpdate(function(){o._loadToFlexGrid(t,n,r);u&&u(n);n=null})},f)}},i._saveFlexGridToWorkbook=function(i,r){var rt=new n.xlsx.Workbook,c=new n.xlsx.WorkSheet,et=new n.xlsx.WorkbookStyle,ut=new n.xlsx.WorkbookFrozenPane,ot=r&&r.includeColumnHeaders!=null?r.includeColumnHeaders:!0,nt=r&&r.includeRowHeaders!=null?r.includeRowHeaders:!1,w=r&&r.includeCellStyles!=null?r.includeCellStyles:!0,lt=r?r.activeWorksheet:null,a=r?r.includeColumns:null,b=r?r.formatItem:null,e,v,k,y,p,o,st,u,s,f,ft,l,g,ht,d,tt=0,it=0,ct=0,h=0;if(ft=i.wj_sheetInfo,c.name=r?r.sheetName:'',c.visible=r?r.sheetVisible!==!1:!0,st={borders:{top:{style:n.xlsx.BorderStyle.Thin,color:'#C6C6C6'},left:{style:n.xlsx.BorderStyle.Thin,color:'#C6C6C6'},bottom:{style:n.xlsx.BorderStyle.Thin,color:'#C6C6C6'},right:{style:n.xlsx.BorderStyle.Thin,color:'#C6C6C6'}}},et._deserialize(st),c.style=et,o=[],!ft&&(w||b)&&(l=document.createElement('div'),l.style.visibility='hidden',l.setAttribute(t.FlexGrid._WJS_MEASURE,'true'),i.hostElement.appendChild(l)),nt){for(s=0,u=0;u<i.rowHeaders.rows.length;u++)if(!(i.rowHeaders.rows[u].renderSize<=0)){for(o[s]=[],f=0;f<i.rowHeaders.columns.length;f++)k=i._getBindingColumn(i.rowHeaders,u,i.rowHeaders.columns[f]),y=this._getColumnSetting(k,i.columnHeaders.columns.defaultSize),o[s][f]=y,s===0&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p,f));s++}h=f}if(ot&&i.columnHeaders.rows.length>0){for(s=0,u=0;u<i.columnHeaders.rows.length;u++)if(!(i.columnHeaders.rows[u].renderSize<=0)){for(o[s]||(o[s]=[]),f=0;f<i.columnHeaders.columns.length;f++)k=i._getBindingColumn(i.columnHeaders,u,i.columnHeaders.columns[f]),y=this._getColumnSetting(k,i.columnHeaders.columns.defaultSize),o[s][h+f]=y,s===0&&(!a||a(k))&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p));h=0;e={};v=new n.xlsx.WorkbookRow;nt&&(h=this._parseFlexGridRowToSheetRow(i.topLeftCells,e,u,0,o,w,l,!1,0,a,b));this._parseFlexGridRowToSheetRow(i.columnHeaders,e,u,h,o,w,l,!1,0,a,b);e.cells.length>0&&(v._deserialize(e),c._addWorkbookRow(v,s));s++}it=s}else for(o[0]||(o[0]=[]),f=0;f<i.columnHeaders.columns.length;f++)k=i._getBindingColumn(i.columnHeaders,0,i.columnHeaders.columns[f]),y=this._getColumnSetting(k,i.columnHeaders.columns.defaultSize),o[0][h+f]=y,(!a||a(k))&&(p=new n.xlsx.WorkbookColumn,p._deserialize(y),c._addWorkbookColumn(p));for(u=0;u<i.cells.rows.length;u++)(h=0,e={},v=new n.xlsx.WorkbookRow,g=i.rows[u],g instanceof t._NewRowTemplate)||(d=g instanceof t.GroupRow,d?(ht=n.tryCast(g,t.GroupRow),tt=ht.level):i.rows.maxGroupLevel>-1&&(tt=i.rows.maxGroupLevel+1),nt&&(h=this._parseFlexGridRowToSheetRow(i.rowHeaders,e,u,0,o,w,l,d,tt,a,b)),this._parseFlexGridRowToSheetRow(i.cells,e,u,h,o,w,l,d,tt,a,b),e.cells.length>0&&(v._deserialize(e),c._addWorkbookRow(v,it+u)));for(ct=i.cells.rows.length,u=0;u<i.columnFooters.rows.length;u++)h=0,e={},v=new n.xlsx.WorkbookRow,g=i.columnFooters.rows[u],d=g instanceof t.GroupRow,nt&&(h=this._parseFlexGridRowToSheetRow(i.rowHeaders,e,u,0,o,w,l,d,0,a,b)),this._parseFlexGridRowToSheetRow(i.columnFooters,e,u,h,o,w,l,d,0,a,b),e.cells.length>0&&(v._deserialize(e),c._addWorkbookRow(v,it+ct+u));return ut.rows=ot?i.frozenRows+it:i.frozenRows,ut.columns=nt?i.frozenColumns+h:i.frozenColumns,c.frozenPane=ut,rt._addWorkSheet(c),!ft&&(w||b)&&i.hostElement.removeChild(l),rt.activeWorksheet=lt,rt},i._loadToFlexGrid=function(i,r,u){var ui=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,w=u&&u.includeColumnHeaders!=null?u.includeColumnHeaders:!0,pt=u&&u.sheetIndex!=null&&!isNaN(u.sheetIndex)?u.sheetIndex:0,dt=u?u.sheetName:null,fi=u?u.sheetVisible:!0,gt=i.wj_sheetInfo!=null,e=0,s=0,p,ut,y,ft,k,b,et,wt,tt,ni,o,c,ti,g,ot,h,st,ht,ii,bt,a,ct,nt,d,l,f,v,kt,lt,at,ri,it,vt=!1,yt={},rt;if(i.itemsSource=null,i.columns.clear(),i.rows.clear(),i.frozenColumns=0,i.frozenRows=0,v={},kt={},s=0,ft=[],lt=[],pt<0||pt>=r.sheets.length)throw'The sheet index option is out of the sheet range of current workbook.';if(dt!=null)for(p=0;p<r.sheets.length;p++)if(dt===r.sheets[p].name){c=r.sheets[p];break}if(c=c||r.sheets[pt],c.rows!=null){for(ui&&(s=1,c.rows.length<=1&&(w=!1,s=0),wt=c.rows[0]),g=this._getColumnCount(c.rows),ti=this._getRowCount(c.rows,g),ii=c.summaryBelow,y=c.columns,e=0;e<g;e++)i.columns.push(new t.Column),!y[e]||(isNaN(+y[e].width)||(i.columns[e].width=+y[e].width),y[e].visible||y[e].visible==undefined||(i.columns[e].visible=!!y[e].visible),y[e].style&&!!y[e].style.wordWrap&&(i.columns[e].wordWrap=y[e].style.wordWrap));for(;s<ti;s++){if(ot=!1,rt=null,o=c.rows[s],o)for(st=s+1;st<c.rows.length;)if(ht=c.rows[st],ht){(isNaN(o.groupLevel)&&!isNaN(ht.groupLevel)||!isNaN(o.groupLevel)&&o.groupLevel<ht.groupLevel)&&(ot=!0);break}else st++;for(ot&&!ii?(a&&(a.isCollapsed=vt),a=new t.GroupRow,a.isReadOnly=!1,vt=o.collapsed==null?!1:o.collapsed,a.level=isNaN(o.groupLevel)?0:o.groupLevel,yt[a.level]=vt,this._checkParentCollapsed(yt,a.level)&&a._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(a)):(bt=new t.Row,o&&this._checkParentCollapsed(yt,o.groupLevel)&&bt._setFlag(t.RowColFlags.ParentCollapsed,!0),i.rows.push(bt)),!o||!o.height||isNaN(o.height)||(i.rows[w?s-1:s].height=o.height),e=0;e<g;e++)if(o){if(h=o.cells[e],d=h?h.formula:undefined,d&&d[0]!=='='&&(d='='+d),i.setCellData(w?s-1:s,e,d&&gt?d:this._getItemValue(h)),ot||this._setColumn(ft,e,h),l=s*g+e,f=h?h.style:undefined,at=n.xlsx.Workbook._parseExcelFormat(h),f){if(rt=rt==null?!!f.wordWrap:rt&&!!f.wordWrap,ri=this._getItemType(h),f.hAlign)it=n.xlsx.Workbook._parseHAlignToString(n.asEnum(f.hAlign,n.xlsx.HAlign));else switch(ri){case n.DataType.Number:it='right';break;case n.DataType.Boolean:it='center';break;default:it=at&&at.search(/[n,c,p]/i)===0?'right':'left'}v[l]={fontWeight:f.font&&f.font.bold?'bold':'none',fontStyle:f.font&&f.font.italic?'italic':'none',textDecoration:f.font&&f.font.underline?'underline':'none',textAlign:it,fontFamily:f.font&&f.font.family?f.font.family:'',fontSize:f.font&&f.font.size?f.font.size+'px':'',color:f.font&&f.font.color?f.font.color:'',backgroundColor:f.fill&&f.fill.color?f.fill.color:'',whiteSpace:f.wordWrap?'pre-wrap':'normal',format:at};f.borders&&(f.borders.left&&(this._parseBorderStyle(f.borders.left.style,'Left',v[l]),v[l].borderLeftColor=f.borders.left.color),f.borders.right&&(this._parseBorderStyle(f.borders.right.style,'Right',v[l]),v[l].borderRightColor=f.borders.right.color),f.borders.top&&(this._parseBorderStyle(f.borders.top.style,'Top',v[l]),v[l].borderTopColor=f.borders.top.color),f.borders.bottom&&(this._parseBorderStyle(f.borders.bottom.style,'Bottom',v[l]),v[l].borderBottomColor=f.borders.bottom.color));f.font&&lt.indexOf(f.font.family)===-1&&lt.push(f.font.family)}if(h&&n.isNumber(h.rowSpan)&&h.rowSpan>0&&n.isNumber(h.colSpan)&&h.colSpan>0&&(h.rowSpan>1||h.colSpan>1))for(p=s;p<s+h.rowSpan;p++)for(ut=e;ut<e+h.colSpan;ut++)l=p*g+ut,kt[l]=new t.CellRange(s,e,s+h.rowSpan-1,e+h.colSpan-1)}else i.setCellData(w?s-1:s,e,''),this._setColumn(ft,e,undefined);o&&(this._checkParentCollapsed(yt,o.groupLevel)||o.visible||o.visible==undefined||(i.rows[w?s-1:s].visible=o.visible),i.rows[w?s-1:s].wordWrap=!!o.style&&!!o.style.wordWrap||!!rt)}for(a&&(a.isCollapsed=vt),c.frozenPane&&(ct=c.frozenPane.columns,n.isNumber(ct)&&!isNaN(ct)&&(i.frozenColumns=ct),nt=c.frozenPane.rows,n.isNumber(nt)&&!isNaN(nt)&&(i.frozenRows=w&&nt>0?nt-1:nt)),e=0;e<i.columnHeaders.columns.length;e++)k=ft[e],b=i.columns[e],b.isRequired=!1,w?(tt=wt?wt.cells[e]:undefined,tt&&tt.value?(ni=n.xlsx.Workbook._parseExcelFormat(tt),et=n.Globalize.format(tt.value,ni)):et=this._numAlpha(e)):et=this._numAlpha(e),b.header=et,k&&(k.dataType===n.DataType.Boolean&&(b.dataType=k.dataType),b.format=k.format,b.align=k.hAlign,b.wordWrap=b.wordWrap||!!k.wordWrap);gt&&(i.wj_sheetInfo.name=c.name,i.wj_sheetInfo.visible=fi===!0?!0:c.visible!==!1,i.wj_sheetInfo.styledCells=v,i.wj_sheetInfo.mergedRanges=kt,i.wj_sheetInfo.fonts=lt)}},i._parseFlexGridRowToSheetRow=function(i,u,f,e,o,s,h,c,l,a,v){var w,k,rt,y,ft,b,p,nt,it,st,ct,bt,ut,d,lt,vt,ht,g,dt=!1,yt,et,gt,pt,kt,tt,ot,wt,at;for(w=i.grid,ht=w.wj_sheetInfo,k=i.rows[f],gt=k.recordIndex!=null?k.recordIndex:0,u.cells||(u.cells=[]),u.visible=k.isVisible,u.height=k.renderHeight||i.rows.defaultSize,u.groupLevel=l,c&&(u.collapsed=k.isCollapsed),k.wordWrap&&(u.style={wordWrap:k.wordWrap}),(k.constructor===n.grid.Row||k.constructor===n.grid._NewRowTemplate||n.grid.detail&&k.constructor===n.grid.detail.DetailRow||n.grid.multirow&&k.constructor===n.grid.multirow._MultiRow)&&(dt=!0),y=0;y<i.columns.length;y++)if(ft=null,vt=1,lt=1,at=0,et=!1,ut=null,ot=null,yt=w._getBindingColumn(i,f,i.columns[y]),d=null,ht&&i===w.cells?(bt=f*i.columns.length+y,ht.mergedRanges&&(d=ht.mergedRanges[bt]),ht.styledCells&&(ut=ht.styledCells[bt])):s&&(tt=h.cloneNode(),i.hostElement.children.length>0?i.hostElement.children[0].appendChild(tt):i.hostElement.appendChild(tt),d=w.getMergedRange(i,f,y,!1),ut=d?this._getCellStyle(i,tt,d.bottomRow,d.rightCol)||{}:this._getCellStyle(i,tt,f,y)||{}),d||(d=w.getMergedRange(i,f,y,!1)),d?f===d.topRow&&y===d.leftCol&&(lt=d.bottomRow-d.topRow+1,vt=this._getColSpan(i,d,a),et=!0):et=!0,!a||a(yt)){if(rt=o[gt][y+e],dt||c?(p=et?i.getCellData(f,y,!0):null,nt=et?i.getCellData(f,y,!1):null,st=!1,p&&n.isString(p)&&p.length>1&&p[0]==='='&&(st=!0),g=n.isDate(nt),ut&&ut.format?(ft=ut.format,b=n.xlsx.Workbook._parseCellFormat(ut.format,g)):rt&&rt.style&&rt.style.format?(ft=yt.format,b=rt.style.format):b=null,b||(g?b='m/d/yyyy':n.isNumber(nt)&&!yt.dataMap?b=n.isInt(nt)?'#,##0':'#,##0.00':st?(ct=p.toLowerCase(),ct.indexOf('now()')>-1?(b='m/d/yyyy h:mm',g=!0):ct.indexOf('today()')>-1||ct.indexOf('date(')>-1?(b='m/d/yyyy',g=!0):ct.indexOf('time(')>-1&&(b='h:mm AM/PM',g=!0)):b='General')):(p=et?w.columnHeaders.getCellData(0,y,!0):null,b='General'),ot=this._parseCellStyle(ut)||{},i===w.cells&&c&&k.hasChildren&&y===w.columns.firstVisibleIndex){if(p?it=p:et&&(it=k.getGroupHeader().replace(/<\/?\w+>/g,'')),it==null&&!ut)continue;g=n.isDate(it);!g&&ft&&ft.toLowerCase()==='d'&&n.isInt(it)&&(b='0');it=typeof it=='string'?n.xlsx.Workbook._unescapeXML(it):it;y===w.columns.firstVisibleIndex&&w.treeIndent&&(at=l);pt={value:it,isDate:g,formula:st?this._parseToExcelFormula(p,g):null,colSpan:vt,rowSpan:lt,style:this._extend(ot,{format:b,font:{bold:!0},hAlign:n.xlsx.HAlign.Left,indent:at})}}else p=typeof p=='string'?n.xlsx.Workbook._unescapeXML(p):p,nt=typeof nt=='string'?n.xlsx.Workbook._unescapeXML(nt):nt,!g&&ft&&ft.toLowerCase()==='d'&&n.isInt(nt)&&(b='0'),wt=ot&&ot.hAlign?ot.hAlign:rt&&rt.style&&rt.style.hAlign!=null?n.asEnum(rt.style.hAlign,n.xlsx.HAlign,!0):n.isDate(nt)?n.xlsx.HAlign.Left:n.xlsx.HAlign.General,y===w.columns.firstVisibleIndex&&w.treeIndent&&(wt===n.xlsx.HAlign.Left||wt===n.xlsx.HAlign.General)&&(at=l),pt={value:st?null:b==='General'?n.isString(p)?p.replace(/^(\')(\s*=)/,'$2'):p:nt,isDate:g,formula:st?this._parseToExcelFormula(p,g):null,colSpan:y<w.columns.firstVisibleIndex?1:vt,rowSpan:lt,style:this._extend(ot,{format:b,hAlign:wt,vAlign:lt>1?i===w.cells||w.centerHeadersVertically===!1?n.xlsx.VAlign.Top:n.xlsx.VAlign.Center:null,indent:at})};v&&(kt=new r(i,new t.CellRange(f,y),tt,h,pt),v(kt),tt=kt.cell);tt&&(tt.parentElement.removeChild(tt),tt=null);u.cells.push(pt)}return e+y},i._parseCellStyle=function(t){var i,u,e,r,f;return t==null?null:(i=t.fontSize,i=i?+i.substring(0,i.indexOf('px')):null,isNaN(i)&&(i=null),u=t.fontWeight,u=u==='bold'||+u>=700,e=t.fontStyle==='italic',r=t.textDecorationStyle,r==null&&(r=t.textDecoration),r=r==='underline',f=t.whiteSpace,f=f?f.indexOf('pre')>-1?!0:!1:!1,{font:{bold:u,italic:e,underline:r,family:this._parseToExcelFontFamily(t.fontFamily),size:i,color:t.color},fill:{color:t.backgroundColor},borders:this._parseBorder(t),hAlign:n.xlsx.Workbook._parseStringToHAlign(t.textAlign),wordWrap:f})},i._parseBorder=function(n){var t={};return t.left=this._parseEgdeBorder(n,'Left'),t.right=this._parseEgdeBorder(n,'Right'),t.top=this._parseEgdeBorder(n,'Top'),t.bottom=this._parseEgdeBorder(n,'Bottom'),t},i._parseEgdeBorder=function(t,i){var u,f=t['border'+i+'Style'],r;if(f&&f!=='none'&&f!=='hidden'){u={};f=f.toLowerCase();switch(f){case'dotted':u.style=n.xlsx.BorderStyle.Dotted;break;case'dashed':u.style=n.xlsx.BorderStyle.Dashed;break;case'double':u.style=n.xlsx.BorderStyle.Double;break;default:r=t['border'+i+'Width'];r&&r.length>2&&(r=+r.substring(0,r.length-2));u.style=r>2?n.xlsx.BorderStyle.Thick:r>1?n.xlsx.BorderStyle.Medium:n.xlsx.BorderStyle.Thin}u.color=t['border'+i+'Color']}return u},i._parseBorderStyle=function(t,i,r){var u='border'+i+'Style',f='border'+i+'Width';switch(t){case n.xlsx.BorderStyle.Dotted:case n.xlsx.BorderStyle.Hair:r[u]='dotted';r[f]='1px';break;case n.xlsx.BorderStyle.Dashed:case n.xlsx.BorderStyle.ThinDashDotDotted:case n.xlsx.BorderStyle.ThinDashDotted:r[u]='dashed';r[f]='1px';break;case n.xlsx.BorderStyle.MediumDashed:case n.xlsx.BorderStyle.MediumDashDotDotted:case n.xlsx.BorderStyle.MediumDashDotted:case n.xlsx.BorderStyle.SlantedMediumDashDotted:r[u]='dashed';r[f]='2px';break;case n.xlsx.BorderStyle.Double:r[u]='double';r[f]='3px';break;case n.xlsx.BorderStyle.Medium:r[u]='solid';r[f]='2px';break;default:r[u]='solid';r[f]='1px'}},i._parseToExcelFontFamily=function(n){var t;return n&&(t=n.split(','),t&&t.length>0&&(n=t[0].replace(/\"|\'/g,''))),n},i._parseToExcelFormula=function(t,i){var r,e,o,h,u,f,s;if(r=t.match(/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi),r)for(u=0;u<r.length;u++)f=r[u],s=f.substring(0,f.lastIndexOf(')'))+', 1)',t=t.replace(f,s);if(r=null,r=t.match(/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi),r)for(u=0;u<r.length;u++)f=r[u],e=f.match(/\"?\w+\"?\s*\,\s*\"(\w+)\"/i),e&&e.length===2&&(o=e[1],/^d{1,4}?$/.test(o)||(h=n.xlsx.Workbook._parseCellFormat(o,i),s=f.replace(o,h),t=t.replace(f,s)));return t},i._getColumnSetting=function(t,i){var r=t.renderWidth;return r=r||i,{autoWidth:!0,width:r,visible:t.visible,style:{format:t.format?n.xlsx.Workbook._parseCellFormat(t.format,t.dataType===n.DataType.Date):'',hAlign:n.xlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(t.getAlignment())),wordWrap:t.wordWrap}}},i._toExcelHAlign=function(n){return(n=n?n.trim().toLowerCase():n,!n)?n:n.indexOf('center')>-1?'center':n.indexOf('right')>-1||n.indexOf('end')>-1?'right':n.indexOf('justify')>-1?'justify':'left'},i._getColumnCount=function(t){for(var f=0,i=0,r,u=0;u<t.length;u++)r=t[u]&&t[u].cells?t[u].cells:[],r&&r.length>0&&(i=r.length,n.isInt(r[i-1].colSpan)&&r[i-1].colSpan>1&&(i=i+r[i-1].colSpan-1),i>f&&(f=i));return f},i._getRowCount=function(t,i){for(var f=t.length,u=f-1,o=0,e,s,r;o<i;o++)n:for(;u>=0;u--)if(e=t[u],s=e&&e.cells?e.cells:[],r=s[o],r&&(r.value!=null&&r.value!==''||n.isInt(r.rowSpan)&&r.rowSpan>1)){n.isInt(r.rowSpan)&&r.rowSpan>1&&u+r.rowSpan>f&&(f=u+r.rowSpan);break n}return f},i._numAlpha=function(n){var t=Math.floor(n/26)-1;return(t>-1?this._numAlpha(t):'')+String.fromCharCode(65+n%26)},i._getItemType=function(t){return t===undefined||t===null||t.value===undefined||t.value===null||isNaN(t.value)?undefined:n.getType(t.value)},i._setColumn=function(t,i,r){var f,e,o,u=t[i];u?(f=this._getItemType(r),u.dataType!==f&&u.dataType===n.DataType.Boolean&&f!==n.DataType.Boolean&&(u.dataType=f),r&&r.value!=null&&r.value!==''&&(e=n.xlsx.Workbook._parseExcelFormat(r),e&&u.format!==e&&e!=='General'&&(u.format=e)),r&&r.style&&(r.style.hAlign&&(o=n.xlsx.Workbook._parseHAlignToString(n.asEnum(r.style.hAlign,n.xlsx.HAlign))),u.wordWrap=u.wordWrap==null?!!r.style.wordWrap:u.wordWrap&&!!r.style.wordWrap),o||f!==n.DataType.Number||(o='right'),u.hAlign=o):t[i]={dataType:this._getItemType(r),format:n.xlsx.Workbook._parseExcelFormat(r),hAlign:'',wordWrap:null}},i._getItemValue=function(t){if(t===undefined||t===null||t.value===undefined||t.value===null)return undefined;var i=t.value;return n.isNumber(i)&&isNaN(i)?'':i instanceof Date&&isNaN(i.getTime())?'':i},i._getCellStyle=function(n,t,i,r){try{n.grid.cellFactory.updateCell(n,i,r,t);t.className=t.className.replace('wj-state-selected','');t.className=t.className.replace('wj-state-multi-selected','')}catch(u){return null}return window.getComputedStyle(t)},i._extend=function(t,i){var r,u;for(r in i)u=i[r],n.isObject(u)&&t[r]?n.copy(t[r],u):t[r]=u;return t},i._checkParentCollapsed=function(n,t){var i=!1;return Object.keys(n).forEach(function(r){n[r]===!0&&i===!1&&!isNaN(t)&&+r<t&&(i=!0)}),i},i._getColSpan=function(n,t,i){for(var u=0,r=t.leftCol;r<=t.rightCol;r++)(!i||i(n.columns[r]))&&u++;return u},i}(),r;i.FlexGridXlsxConverter=u;r=function(n){function t(t,i,r,u,f){var e=n.call(this,t,i)||this;return e._cell=r,e._patternCell=u,e._xlsxCell=f,e}return __extends(t,n),Object.defineProperty(t.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(n){this._xlsxCell=n},enumerable:!0,configurable:!0}),t.prototype.getFormattedCell=function(){return this._cell||(this._cell=this._patternCell.cloneNode(),this.panel.hostElement.children[0].appendChild(this._cell),u._getCellStyle(this.panel,this._cell,this.range.row,this.range.col)),this._cell},t}(n.grid.CellRangeEventArgs);i.XlsxFormatItemEventArgs=r})(i=t.xlsx||(t.xlsx={}))})(t=n.grid||(n.grid={}))})(wijmo||(wijmo={}))