/*
    *
    * Wijmo Library 5.20172.359
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
var __extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),__decorate=this&&this.__decorate||function(n,t,i,r){var f=arguments.length,u=f<3?t:r===null?r=Object.getOwnPropertyDescriptor(t,i):r,e,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(e=n[o])&&(u=(f<3?e(u):f>3?e(t,i,u):e(t,i))||u);return f>3&&u&&Object.defineProperty(t,i,u),u},__param=this&&this.__param||function(n,t){return function(i,r){t(i,r,n)}};define("wijmo/wijmo.angular2.grid",["require","exports","@angular/core","@angular/core","@angular/core","@angular/common","@angular/forms","wijmo/wijmo.angular2.directiveBase"],function(n,t,i,r,u,f,e,o){"use strict";var c,l,h,s,y,p,v,w,b,a;Object.defineProperty(t,"__esModule",{value:!0});t.wjFlexGridMeta={selector:'wj-flex-grid',template:"<div><ng-content></ng-content></div>",inputs:['wjModelProperty','isDisabled','newRowAtTop','allowAddNew','allowDelete','allowDragging','allowMerging','allowResizing','allowSorting','autoSizeMode','autoGenerateColumns','childItemsPath','groupHeaderFormat','headersVisibility','showSelectedHeaders','showMarquee','itemFormatter','isReadOnly','imeEnabled','mergeManager','selectionMode','showGroups','showSort','showDropDown','showAlternatingRows','showErrors','validateEdits','treeIndent','itemsSource','autoClipboard','frozenRows','frozenColumns','deferResizing','sortRowIndex','stickyHeaders','preserveSelectedState','preserveOutlineState','keyActionTab','keyActionEnter','rowHeaderPath','virtualizationThreshold',],outputs:['initialized','gotFocusNg: gotFocus','lostFocusNg: lostFocus','beginningEditNg: beginningEdit','cellEditEndedNg: cellEditEnded','cellEditEndingNg: cellEditEnding','prepareCellForEditNg: prepareCellForEdit','formatItemNg: formatItem','resizingColumnNg: resizingColumn','resizedColumnNg: resizedColumn','autoSizingColumnNg: autoSizingColumn','autoSizedColumnNg: autoSizedColumn','draggingColumnNg: draggingColumn','draggingColumnOverNg: draggingColumnOver','draggedColumnNg: draggedColumn','sortingColumnNg: sortingColumn','sortedColumnNg: sortedColumn','resizingRowNg: resizingRow','resizedRowNg: resizedRow','autoSizingRowNg: autoSizingRow','autoSizedRowNg: autoSizedRow','draggingRowNg: draggingRow','draggingRowOverNg: draggingRowOver','draggedRowNg: draggedRow','deletingRowNg: deletingRow','deletedRowNg: deletedRow','loadingRowsNg: loadingRows','loadedRowsNg: loadedRows','rowEditStartingNg: rowEditStarting','rowEditStartedNg: rowEditStarted','rowEditEndingNg: rowEditEnding','rowEditEndedNg: rowEditEnded','rowAddedNg: rowAdded','groupCollapsedChangedNg: groupCollapsedChanged','groupCollapsedChangingNg: groupCollapsedChanging','itemsSourceChangedNg: itemsSourceChanged','selectionChangingNg: selectionChanging','selectionChangedNg: selectionChanged','scrollPositionChangedNg: scrollPositionChanged','updatingViewNg: updatingView','updatedViewNg: updatedView','updatingLayoutNg: updatingLayout','updatedLayoutNg: updatedLayout','pastingNg: pasting','pastedNg: pasted','pastingCellNg: pastingCell','pastedCellNg: pastedCell','copyingNg: copying','copiedNg: copied',],providers:[{provide:e.NG_VALUE_ACCESSOR,useFactory:o.WjValueAccessorFactory,multi:!0,deps:['WjComponent']}]};c=w=function(n){function t(t,i,r,u){var f=n.call(this,o.WjDirectiveBehavior.getHostElement(t,i))||this,e;return f.isInitialized=!1,e=f._wjBehaviour=o.WjDirectiveBehavior.attach(f,t,i,r),new y(f,u),f.deferUpdate(function(){if(f.rows.defaultSize<10){var t=f.hostElement,i=getComputedStyle(t),r=getComputedStyle(document.body),n=parseInt(i.fontSize&&wijmo.contains(document.body,t)?i.fontSize:r.fontSize)*2;f.rows.defaultSize=n;f.columns.defaultSize=n*4;f.columnHeaders.rows.defaultSize=n;f.rowHeaders.columns.defaultSize=Math.round(n*1.25)}}),f.created(),f}return __extends(t,n),t.prototype.created=function(){},t.prototype.ngOnInit=function(){this._wjBehaviour.ngOnInit()},t.prototype.ngAfterViewInit=function(){this._wjBehaviour.ngAfterViewInit()},t.prototype.ngOnDestroy=function(){this._wjBehaviour.ngOnDestroy()},t.prototype.addEventListener=function(t,i,r,u){var s=this,f,e;u===void 0&&(u=!1);f=o.WjDirectiveBehavior;e=f.ngZone;e&&f.outsideZoneEvents[i]?e.runOutsideAngular(function(){n.prototype.addEventListener.call(s,t,i,r,u)}):n.prototype.addEventListener.call(this,t,i,r,u)},t}(wijmo.grid.FlexGrid);c.meta={outputs:t.wjFlexGridMeta.outputs};c=w=__decorate([i.Component({selector:t.wjFlexGridMeta.selector,template:t.wjFlexGridMeta.template,inputs:t.wjFlexGridMeta.inputs,outputs:t.wjFlexGridMeta.outputs,providers:[{provide:'WjComponent',useExisting:r.forwardRef(function(){return w})}].concat(t.wjFlexGridMeta.providers)}),__param(0,u.Inject(r.ElementRef)),__param(1,u.Inject(r.Injector)),__param(2,u.Inject('WjComponent')),__param(2,u.SkipSelf()),__param(2,r.Optional()),__param(3,u.Inject(u.ChangeDetectorRef))],c);t.WjFlexGrid=c;t.wjFlexGridColumnMeta={selector:'wj-flex-grid-column',template:"<div><ng-content></ng-content></div>",inputs:['asyncBindings','wjProperty','name','dataMap','dataType','binding','sortMemberPath','format','header','width','maxLength','minWidth','maxWidth','align','allowDragging','allowSorting','allowResizing','allowMerging','aggregate','isReadOnly','cssClass','isContentHtml','isSelected','visible','wordWrap','mask','inputType','isRequired','showDropDown','dropDownCssClass',],outputs:['initialized','isSelectedChangePC: isSelectedChange',],providers:[]};l=b=function(n){function t(t,i,r){var u=n.call(this)||this,e,f;return u.isInitialized=!1,u.wjProperty='columns',e=u._wjBehaviour=o.WjDirectiveBehavior.attach(u,t,i,r),f=e.parentBehavior.directive,f.autoGenerateColumns&&(f.autoGenerateColumns=!1,f.columns.clear()),u.created(),u}return __extends(t,n),t.prototype.created=function(){},t.prototype.ngOnInit=function(){this._wjBehaviour.ngOnInit()},t.prototype.ngAfterViewInit=function(){this._wjBehaviour.ngAfterViewInit()},t.prototype.ngOnDestroy=function(){this._wjBehaviour.ngOnDestroy()},t}(wijmo.grid.Column);l.meta={outputs:t.wjFlexGridColumnMeta.outputs,changeEvents:{'grid.selectionChanged':['isSelected']}};l=b=__decorate([i.Component({selector:t.wjFlexGridColumnMeta.selector,template:t.wjFlexGridColumnMeta.template,inputs:t.wjFlexGridColumnMeta.inputs,outputs:t.wjFlexGridColumnMeta.outputs,providers:[{provide:'WjComponent',useExisting:r.forwardRef(function(){return b})}].concat(t.wjFlexGridColumnMeta.providers)}),__param(0,u.Inject(r.ElementRef)),__param(1,u.Inject(r.Injector)),__param(2,u.Inject('WjComponent')),__param(2,u.SkipSelf()),__param(2,r.Optional())],l);t.WjFlexGridColumn=l;h=a=function(){function n(n,t,i,r,u,f,e){this.viewContainerRef=n;this.templateRef=t;this.elRef=i;this.domRenderer=u;this.cdRef=e;this.autoSizeRows=!0;r instanceof c?this.grid=r:r instanceof l&&(this.column=r,this.grid=o.WjDirectiveBehavior.getBehavior(r).parentBehavior.directive)}return n._getTemplContextProp=function(n){return'$__cellTempl'+s[n]},n.prototype.ngOnInit=function(){this.ownerControl=this.column&&this.column.grid===this.grid?this.column:this.grid;this._attachToControl()},n.prototype.ngOnDestroy=function(){this.cellTypeStr&&(this.viewContainerRef.clear(),this.ownerControl[a._getTemplContextProp(this.cellType)]=null,this.grid.invalidate())},n.prototype._instantiateTemplate=function(n){return o.WjDirectiveBehavior.instantiateTemplate(n,this.viewContainerRef,this.templateRef,this.domRenderer)},n.prototype._attachToControl=function(){this.cellTypeStr&&(this.cellType=wijmo.asEnum(this.cellTypeStr,s),this.ownerControl[a._getTemplContextProp(this.cellType)]=this,this.grid.invalidate())},n}();h=a=__decorate([r.Directive({selector:'[wjFlexGridCellTemplate]',inputs:['wjFlexGridCellTemplate','cellTypeStr: cellType','cellOverflow','valuePaths','autoSizeRows'],exportAs:'wjFlexGridCellTemplate',providers:[{provide:'WjComponent',useExisting:r.forwardRef(function(){return a})}]}),__param(0,u.Inject(r.ViewContainerRef)),__param(1,u.Inject(r.TemplateRef)),__param(1,r.Optional()),__param(2,u.Inject(r.ElementRef)),__param(3,u.Inject('WjComponent')),__param(3,u.SkipSelf()),__param(3,r.Optional()),__param(4,u.Inject(r.Renderer)),__param(5,u.Inject(r.Injector)),__param(6,u.Inject(u.ChangeDetectorRef))],h);t.WjFlexGridCellTemplate=h,function(n){n[n.Cell=0]="Cell";n[n.CellEdit=1]="CellEdit";n[n.ColumnHeader=2]="ColumnHeader";n[n.RowHeader=3]="RowHeader";n[n.RowHeaderEdit=4]="RowHeaderEdit";n[n.TopLeft=5]="TopLeft";n[n.GroupHeader=6]="GroupHeader";n[n.Group=7]="Group";n[n.NewCellTemplate=8]="NewCellTemplate";n[n.ColumnFooter=9]="ColumnFooter";n[n.BottomLeft=10]="BottomLeft"}(s=t.CellTemplateType||(t.CellTemplateType={}));y=function(n){function t(i,r){var u=n.call(this)||this,e,f;if(u._needsCdCheck=!1,u._lastApplyTimeStamp=0,u._noApplyLag=!1,u._startingEditing=!1,u._cellStampCounter=0,u._composing=!1,u.grid=i,u._gridCdRef=r,!t._templateTypes){t._templateTypes=[];for(e in s)isNaN(e)&&t._templateTypes.push(e)}return f=u,u._baseCf=i.cellFactory,i.cellFactory=u,u._evtInput=document.createEvent('HTMLEvents'),u._evtInput.initEvent('input',!0,!1),u._evtBlur=document.createEvent('HTMLEvents'),u._evtBlur.initEvent('blur',!1,!1),i.prepareCellForEdit.addHandler(function(){f._noApplyLag=!0}),i.cellEditEnded.addHandler(function(n,t){(t.range.col<0||t.range.col<i.columns.length&&!i.columns[t.range.col][h._getTemplContextProp(s.CellEdit)])&&(f._editChar=null);setTimeout(function(){f._noApplyLag=!1},300)}),i.beginningEdit.addHandler(function(){f._startingEditing=!0}),i.hostElement.addEventListener('keydown',function(){f._startingEditing=!1},!0),i.hostElement.addEventListener('keypress',function(n){var t=n.charCode>32?String.fromCharCode(n.charCode):null;t&&(!i.activeEditor||f._startingEditing?f._editChar=t:f._editChar&&(f._editChar+=t))},!0),i.hostElement.addEventListener('compositionstart',function(){f._composing=!0},!0),i.hostElement.addEventListener('compositionend',function(){f._composing=!1},!0),i.updatedView.addHandler(function(){u._needsCdCheck&&(u._needsCdCheck=!1,u._gridCdRef.markForCheck())},u),u}return __extends(t,n),t.prototype.updateCell=function(n,i,r,u,f){var tt=this,lt,rt,ut,y,a,l,at,vt,ft,yt,ot,st,w,ht,ct;this._cellStampCounter=(this._cellStampCounter+1)%1e7;lt=u[t._cellStampProp]=this._cellStampCounter;u.style.overflow&&(u.style.overflow='');var b=this,o=n.grid,it=o.editRange,e,p=n.rows[i],k=p.dataItem,d=!1,g=!1,v=!1,nt=!1;switch(n.cellType){case wijmo.grid.CellType.Cell:it&&it.row===i&&it.col===r?(e=s.CellEdit,g=v=!0):p instanceof wijmo.grid.GroupRow?(nt=k instanceof wijmo.collections.CollectionViewGroup,rt=!(nt||p.hasChildren),r==n.columns.firstVisibleIndex?e=rt?s.Cell:s.GroupHeader:(e=rt?s.Cell:s.Group,g=!0)):p instanceof wijmo.grid._NewRowTemplate?e=s.NewCellTemplate:wijmo.grid.detail&&wijmo.grid.detail.DetailRow&&p instanceof wijmo.grid.detail.DetailRow||(e=s.Cell);break;case wijmo.grid.CellType.ColumnHeader:e=s.ColumnHeader;break;case wijmo.grid.CellType.RowHeader:e=o.collectionView&&o.collectionView.currentEditItem===k?s.RowHeaderEdit:s.RowHeader;d=!0;break;case wijmo.grid.CellType.TopLeft:e=s.TopLeft;d=!0;break;case wijmo.grid.CellType.ColumnFooter:e=s.ColumnFooter;g=!0;break;case wijmo.grid.CellType.BottomLeft:e=s.BottomLeft;d=!0}if(ut=!1,e!=null&&(y=nt&&e==s.GroupHeader?o.columns.getColumn(k.groupDescription.propertyName):r>=0&&r<n.columns.length?n.columns[r]:null,y&&(a=h._getTemplContextProp(e),l=(d?o:y)[a],l||(e===s.RowHeaderEdit?(e=s.RowHeader,a=h._getTemplContextProp(e),l=o[a]):(e===s.Group||e===s.GroupHeader)&&(nt||(e=s.Cell,a=h._getTemplContextProp(e),l=y[a]))),l&&(at=!0,g&&(vt=n.getCellData(i,r,!1)),at)))){ut=!0;ft=u.getAttribute(wijmo.grid.FlexGrid._WJS_MEASURE);yt=ft&&ft.toLowerCase()==='true';v&&this._baseCf.updateCell(n,i,r,u,f,!0);var c=u[a]||{},pt=c.column!==y||!c.viewRef||c.templateContextProperty!==a||u.firstChild!=c.rootElement,et=v&&this._composing&&o.imeEnabled;pt&&(v?(ot=u.firstElementChild,ot&&(et||u.focus(),ot.style.display='none')):u.textContent='',this._doDisposeCell(u),st=l._instantiateTemplate(u),c.column=y,c.viewRef=st.viewRef,c.rootElement=st.rootElement,c.templateContextProperty=a,u[a]=c);w=this._setViewRefVars(c.viewRef,p,y,k,vt,l.valuePaths);l.cellOverflow&&(u.style.overflow=l.cellOverflow);yt?l.cdRef.detectChanges():l.autoSizeRows&&!et?setTimeout(function(){if(lt===u[t._cellStampProp]){var e=u.scrollHeight,r=n.rows,s=f&&f.rowSpan||1;if(i<r.length&&r[i].renderHeight*s<e-1){if(r.defaultSize=e/s,v){o.refresh();o.startEditing();return}}else v&&tt._initEditInput(c,null)}},0):v&&setTimeout(function(){et?tt._initImeEditInput(c):tt._initEditInput(c,null)},0);v?(b._cellEditorVars=w.localVars,ht=function(n,t){var r,s,h,i,f,e,c;if(o.cellEditEnding.removeHandler(ht),t.stayInEditMode||(r=wijmo.getActiveElement(),r&&r.dispatchEvent(b._evtBlur),u.focus()),b._triggerEditorEvents(u),!(t.cancel||t.stayInEditMode))for(s=w.localVars,h=Object.getOwnPropertyNames(w.bindings),i=0,f=h;i<f.length;i++)e=f[i],w.bindings[e].setValue(s,w.localVars.values[e]);c=u.querySelectorAll('.wj-dropdown');[].forEach.call(c,function(n){var t=wijmo.Control.getControl(n);t&&wijmo.input&&t instanceof wijmo.input.DropDown&&(t.isDroppedDown=!1)})},ct=function(){o.cellEditEnded.removeHandler(ct);b._cellEditorVars=null},o.cellEditEnding.addHandler(ht),o.cellEditEnded.addHandler(ct)):this._baseCf.updateCell(n,i,r,u,f,!1)}ut||(this._doDisposeCell(u),this._baseCf.updateCell(n,i,r,u,f))},t.prototype.getEditorValue=function(t){if(this._cellEditorVars){var i=t.editRange;return i&&i.isValid&&this._triggerEditorEvents(t.cells.getCellElement(i.row,i.col)),this._cellEditorVars.value}return n.prototype.getEditorValue.call(this,t)},t.prototype.disposeCell=function(n){this._doDisposeCell(n)},t.prototype._doDisposeCell=function(n){for(var r,i,c,u,e,o=t._templateTypes,f=0;f<o.length;f++)r=h._getTemplContextProp(s[o[f]]),i=n[r],i&&i.viewRef&&(c=i.column||this.grid,u=c[r],u&&(e=u.viewContainerRef.indexOf(i.viewRef),e>-1&&u.viewContainerRef.remove(e)),i.viewRef=null,i.rootElement=null,i.column=null,i.templateContextProperty=null,n[r]=null)},t.prototype._setViewRefVars=function(n,t,i,r,u,f){var v,o,h,s,c;this._needsCdCheck=!0;n.context.row=t;n.context.col=i;n.context.item=r;var l={},e=n.context.cell||{},a={},y={localVars:e,bindings:a};if(e.row=t,e.col=i,e.item=r,e.value=u,e.values=l,f)for(v=Object.getOwnPropertyNames(f),o=0,h=v;o<h.length;o++)s=h[o],c=new wijmo.Binding(f[s]),a[s]=c,l[s]=c.getValue(e);return n.context.cell!==e&&(n.context.cell=e),y},t.prototype._initEditInput=function(n,t){var r=this,i=this._findInitialInput(n),f=window.getComputedStyle(i),u;f.display!=='none'&&f.visibility==='visible'&&(u=function(){i.removeEventListener('focus',u);setTimeout(function(){setTimeout(function(){var n=t!=null?t:r._editChar,u,f;n&&(u=!0,f=i.selectionStart+n.length,i.value=n,r._editChar=null,i.dispatchEvent(r._evtInput),u&&setTimeout(function(){setTimeout(function(){wijmo.setSelectionRange(i,Math.min(f,i.value.length),i.value.length)},0)},0))},0)},0)},i.addEventListener('focus',u),i.focus())},t.prototype._initImeEditInput=function(n){var o=this,t=wijmo.getActiveElement(),r,u;if(t&&t instanceof HTMLInputElement&&wijmo.hasClass(t,'wj-grid-ime')&&(r=function(){t.removeEventListener('compositionend',r);wijmo.setCss(t,wijmo.grid._ImeHandler._cssHidden);o._initEditInput(n,t.value)},t.addEventListener('compositionend',r),u=this._findInitialInput(n),u)){var i=u.getBoundingClientRect(),f=t.getBoundingClientRect(),e=window.getComputedStyle(t),s=parseFloat(e.left),h=parseFloat(e.top);wijmo.setCss(t,{left:s+i.left-f.left+'px',top:h+i.top-f.top+'px',width:i.width+'px',height:i.height+'px'})}},t.prototype._findInitialInput=function(n){var i=n&&n.rootElement&&n.rootElement.querySelectorAll('input'),t,r,u;if(i)for(t=0;t<i.length;t++)if(r=i[t],u=window.getComputedStyle(r),u.display!=='none'&&u.visibility==='visible')return r;return null},t.prototype._triggerEditorEvents=function(n){var i,t,f,r,u;if(n)for(i=n.querySelectorAll('.wj-control'),t=0;t<i.length;t++)f=i[t],r=wijmo.Control.getControl(f),r&&(u=o.WjDirectiveBehavior.getBehavior(r),u&&u.flushPendingEvents())},t}(wijmo.grid.CellFactory);y._cellStampProp='__wjCellStamp';p=[c,l,h];v=function(){function n(){}return n}();v=__decorate([i.NgModule({imports:[o.WjDirectiveBaseModule,f.CommonModule],declarations:p.slice(),exports:p.slice()})],v);t.WjGridModule=v})